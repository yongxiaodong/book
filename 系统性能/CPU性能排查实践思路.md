top命令查看CPU使用率、IO等待情况




## 第一步： 明确切入点

- CPU使用率高，io等待高  
>  CPU使用率不高，但是负载高的情况，一般都是IO等待引起的
>  证明性能瓶颈可能出现在IO上面， 应尝试把排查重点切入到IO性能排查
>  iostat -x 继续观察读写速度、IOPS

- CPU使用率高，io等待低  
> 证明性能瓶颈不在IO上  
> 还是把重点放在CPU计算能力瓶颈上



## 第二步： 性能开销定位

### CPU性能开销定位  

- 概念明确
> CPU负载高和CPU使用率高是不同的两个概念(比如`w`或者`sar -q`看到的`load average`是CPU负载)

通过原生top命令，然后按p通过CPU使用率排序，尝试定位高CPU开销进程

- 一般正常进程都可以直接通过top看到明显的cpu消耗比例
- 如果是木马类隐藏的进程，通过top是看不到的,可以尝试使用htop和busybox top命令（这里涉及到一个top的原理，top是通过遍历/proc/<PID>的方式去统计每个进程对CPU的消耗，如果这个进程没有在/proc下生成pid，那么top是统计不到的）








### IO性能开销定位







